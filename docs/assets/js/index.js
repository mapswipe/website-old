!function(){function e(t,r,o){function a(s,i){if(!r[s]){if(!t[s]){var p="function"==typeof require&&require;if(!i&&p)return p(s,!0);if(n)return n(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[s]={exports:{}};t[s][0].call(l.exports,function(e){return a(t[s][1][e]||e)},l,l.exports,e,t,r,o)}return r[s].exports}for(var n="function"==typeof require&&require,s=0;s<o.length;s++)a(o[s]);return a}return e}()({1:[function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),n=function(){function e(t){o(this,e),this.root=t,this.bindEvents()}return a(e,[{key:"toggleNav",value:function(e){var t=e.currentTarget,r=e.currentTarget.parentNode.parentNode;r.classList.contains("active")?this.closeNav(t,r):this.openNav(t,r)}},{key:"openNav",value:function(e,t){t.classList.add("active"),e.classList.add("active"),document.querySelector("body").classList.add("menu-active")}},{key:"closeNav",value:function(e,t){t.classList.remove("active"),e.classList.remove("active"),document.querySelector("body").classList.remove("menu-active")}},{key:"bindEvents",value:function(){this.root.addEventListener("click",this.toggleNav.bind(this))}}]),e}();r.default=n},{}],2:[function(e,t,r){"use strict";function o(){var e=L.control({position:"topright"});e.onAdd=function(e){var t=L.DomUtil.create("div","info legend");return t.innerHTML+='<i style="background:orange"></i>active<br>',t.innerHTML+='<i style="background:blue"></i>finished<br>',t.innerHTML+='<i style="background:grey"></i>inactive<br>',t},e.addTo(s)}function a(e){var t=$.ajax({url:e,dataType:"json",success:console.log("mapswipe project centroids data successfully loaded."),error:function(e){alert(e.statusText)}});$.when(t).done(function(){var e={radius:6,fillColor:"grey",color:"white",weight:1,opacity:1,fillOpacity:.8},r=L.geoJSON(t.responseJSON,{pointToLayer:function(t,r){return L.circleMarker(r,e)}});r.setStyle(function(e){return"active"==e.properties.status?{fillColor:"orange",color:"black",radius:9}:"finished"==e.properties.status?{fillColor:"blue"}:"inactive"==e.properties.status?{fillColor:"grey"}:void 0}).addTo(s),r.bindPopup(function(e){return popup='<a href="project.html?projectId='+e.feature.properties.project_id+'">'+e.feature.properties.name+"</a>",popup}),s.fitBounds(r.getBounds()),n(t.responseJSON);for(var o=t.responseJSON.features.filter(function(e){return"finished"==e.properties.status|"archived"==e.properties.status}),a=0,i=0;i<o.length;i++){var p=parseFloat(o[i].properties.area_sqkm);p>0&&(a+=p)}document.getElementById("stats-finished-projects").innerHTML=o.length,document.getElementById("stats-mapped-area").innerHTML=(1e3*parseInt(a/1e3)).toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")})}function n(e){console.log("added projects");var t=document.getElementById("projectsTable").getElementsByTagName("tbody")[0];e.features.forEach(function(e){var r=t.insertRow(),o=document.createElement("td");o.innerHTML='<a href="project.html?projectId='+e.properties.project_id+'">'+e.properties.name+"</a>",r.appendChild(o),o=document.createElement("td"),o.innerHTML=e.properties.status,r.appendChild(o),o=document.createElement("td"),e.properties.progress>0?o.innerHTML=Math.round(100*e.properties.progress)+"%":o.innerHTML="not available",r.appendChild(o),o=document.createElement("td"),parseInt(e.properties.number_of_users)>0?o.innerHTML=e.properties.number_of_users:o.innerHTML="not available",r.appendChild(o)}),$("#projectsTable").DataTable(),$(".dataTables_length").addClass("bs-select")}var s;r.initMap=function(){s=L.map("map").setView([0,0],2),L.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png",{attribution:'Map tiles by <a href="https://carto.com/">Carto</a>, under <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0.</a> Data by <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>, under ODbL.',subdomains:["a","b","c"]}).addTo(s),console.log("added map");setTimeout(function(){s.invalidateSize()},400),a("https://apps.mapswipe.org/api/projects/projects_centroid.geojson"),o()}},{}],3:[function(e,t,r){"use strict";function o(e){var t=window.location.search.substring(1);console.log(t);for(var r=t.split("&"),o=0;o<r.length;o++){var a=r[o].split("=");if(a[0]==e)return a[1]}return!1}function a(){u=L.map("map").setView([0,0],2),L.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png",{attribution:'Map tiles by <a href="https://carto.com/">Carto</a>, under <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0.</a> Data by <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>, under ODbL.',subdomains:["a","b","c"]}).addTo(u),console.log("added map"),setTimeout(function(){u.invalidateSize()},400);var e=L.control({position:"bottomleft"});e.onAdd=function(e){var t=L.DomUtil.create("div","info legend");return t.innerHTML+='<i style="background:orange"></i>active<br>',t.innerHTML+='<i style="background:blue"></i>finished<br>',t.innerHTML+='<i style="background:grey"></i>inactive<br>',t},e.addTo(u)}function n(e,t){var r=$.ajax({url:e,dataType:"json",success:console.log("mapswipe project centroids data successfully loaded."),error:function(e){alert(e.statusText)}});$.when(r).done(function(){var e={fillColor:"grey",color:"white",weight:1,opacity:1,fillOpacity:.4},o=L.geoJSON(r.responseJSON,{style:e});o.setStyle(function(e){if("active"==e.properties.status)var r={fillColor:"orange",color:"black"};else"finished"==e.properties.status?r={fillColor:"blue"}:"inactive"==e.properties.status&&(r={fillColor:"grey"});return e.properties.project_id==t&&(r.color="black",r.weight=3),r}).addTo(u),o.bindPopup(function(e){return popup='<a href="project.html?projectId='+e.feature.properties.project_id+'">'+e.feature.properties.name+"</a>",popup}),s(o,t);var a=r.responseJSON.features.filter(function(e){return e.properties.project_id==t})[0].properties;document.getElementById("project-info-name").innerHTML=a.name,document.getElementById("project-info-status").innerHTML=a.status,document.getElementById("project-info-description").innerHTML=a.project_details,document.getElementById("project-info-progress").innerHTML=parseInt(Math.round(100*a.progress)),document.getElementById("project-info-contributors").innerHTML=a.number_of_users,document.getElementById("project-info-area").innerHTML=parseInt(a.area_sqkm).toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")})}function s(e,t){e.eachLayer(function(e){e.feature.properties.project_id==t&&(console.log("zoom to feature"),u.fitBounds(e.getBounds()))})}function i(e){var t=[{name:"Aggregated Results",url:"https://apps.mapswipe.org/api/agg_results/agg_results_"+e+".csv",description:"aggregated results",datatype:"CSV"},{name:"Aggregated Results (with Geometry)",url:"https://apps.mapswipe.org/api/agg_results/agg_results_"+e+"_geom.geojson",description:"aggregated results",datatype:"GeoJSON"},{name:"HOT Tasking Manager Geometries",url:"https://apps.mapswipe.org/api/hot_tm/hot_tm_"+e+".geojson",description:'This dataset contains shapes that are ready to use in the HOT Tasking Manager. Currently, the geometries consist of maximum 15 MapSwipe Tasks, where at least 35% of all users indicated the presence of a building by classifying as "yes" or "maybe"',datatype:"GeoJSON"},{name:"Moderate to High Agreement Yes Maybe Geometries",url:"https://apps.mapswipe.org/api/yes_maybe/yes_maybe_"+e+".geojson",description:'This dataset contains all results where at least 35% of users submitted a "yes" or "maybe" classification. The output dataset depicts the union of all selected results.',datatype:"GeoJSON"},{name:"Groups",url:"https://apps.mapswipe.org/api/groups/groups_"+e+".csv",description:"Groups",datatype:"CSV"},{name:"History",url:"https://apps.mapswipe.org/api/history/history_"+e+".csv",description:"History",datatype:"CSV"},{name:"Results",url:"https://apps.mapswipe.org/api/results/results_"+e+".csv",description:"Results",datatype:"CSV"},{name:"Tasks",url:"https://apps.mapswipe.org/api/tasks/tasks_"+e+".csv",description:"Tasks",datatype:"CSV"}],r=document.getElementById("projectDataTable").getElementsByTagName("tbody")[0];t.forEach(function(t){var o=r.insertRow(),a=document.createElement("td");a.innerHTML=e,o.appendChild(a),a=document.createElement("td"),a.innerHTML=t.name,o.appendChild(a),a=document.createElement("td"),a.innerHTML=t.datatype,o.appendChild(a),a=document.createElement("td"),a.innerHTML=t.description,o.appendChild(a),a=document.createElement("td"),a.innerHTML='<a href="'+t.url+'" target="_blank">Download</a>',o.appendChild(a)})}function p(e,t,r){Plotly.d3.csv(e,function(e){c(e,t,r)})}function c(e,t,r){for(var o=[],a=[],n=0;n<e.length;n++){var s=e[n];o.push(s.day),a.push(100*s[r])}l(o,a,t,r)}function l(e,t,r,o){var a=(document.getElementById("plot"),[{x:e,y:t}]);if("cum_progress"==o)var n={autosize:350,height:350,margin:{l:40,r:40,b:40,t:60,pad:4},yaxis:{range:[0,101]},title:{text:"Progress [%]"}};else var n={};Plotly.newPlot(o,a,n,{displayModeBar:!1})}var u;r.initAnalyticsProject=function(){var e=o("projectId").toString();console.log(e),a();var t="https://apps.mapswipe.org/api/projects/projects_geom.geojson";n(t,e),t="https://apps.mapswipe.org/api/history/history_"+e+".csv",p(t,e,"cum_progress"),i(e)}},{}],4:[function(e,t,r){"use strict";function o(e,t){t.forEach(function(t){e.classList.remove(t)})}function a(){var e=document.body.clientWidth,t="default";return e>=1344&&(t="desktop-wide"),e<1344&&(t="desktop-compact"),e<1024&&(t="tablet-portrait"),e<768&&(t="mobile-landscape"),e<481&&(t="mobile-portrait"),o(d,["default","desktop-compact","tablet-portrait","mobile-landscape","mobile-portrait"]),d.classList.add(t),t}function n(){return"ontouchstart"in window||"onmsgesturechange"in window?(d.classList.add("touchenabled"),!0):(d.classList.remove("touchenabled"),!1)}function s(){var e="desktop";switch(a()){case"desktop-compact":e="desktop",n()&&(e="tablet");break;case"tablet-portrait":e="tablet";break;case"mobile-landscape":case"mobile-portrait":e="mobile"}return o(d,["mobile","tablet","tablet-portrait","desktop"]),d.classList.add(e),e}function i(){s(),a();m=!!d.classList.contains("mobile")}var p=e("./components/navigation.js"),c=function(e){return e&&e.__esModule?e:{default:e}}(p),l=e("./components/overviewStats.js"),u=e("./components/projectStats.js"),d=document.querySelector("html"),m=!1,f=void 0;if(d.classList.contains("mobile")&&(m=!0),d.querySelector("#year")){var g=new Date;d.querySelector("#year").innerHTML=g.getFullYear()}d.querySelector(".burger-menu")&&new c.default(d.querySelector(".burger-menu")),a(),s(),n(),window.addEventListener("resize",function(){clearTimeout(f),f=setTimeout(i,500)}),window.initMap=l.initMap,window.initAnalyticsProject=u.initAnalyticsProject},{"./components/navigation.js":1,"./components/overviewStats.js":2,"./components/projectStats.js":3}]},{},[4,2,3]);
//# sourceMappingURL=index.js.map
